<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Admin Dashboard ‚Äî LumCake</title>
  <link rel="stylesheet" href="styles.css">
  <style>
    .admin-container {
      display: flex;
      min-height: 100vh;
      background: var(--bg);
    }

    .admin-sidebar {
      width: 260px;
      background: linear-gradient(180deg, rgba(255,255,255,0.95), rgba(255,250,255,0.9));
      padding: 24px;
      box-shadow: 2px 0 20px rgba(99,82,110,0.1);
      position: sticky;
      top: 0;
      height: 100vh;
      overflow-y: auto;
    }

    .admin-sidebar h2 {
      color: #B3527E;
      margin-top: 0;
      font-size: 18px;
    }

    .admin-menu {
      list-style: none;
      padding: 0;
      margin: 0;
    }

    .admin-menu li {
      margin-bottom: 8px;
    }

    .admin-menu button {
      width: 100%;
      padding: 12px 16px;
      background: transparent;
      border: 1px solid rgba(179,82,126,0.2);
      border-radius: 8px;
      cursor: pointer;
      font-weight: 600;
      color: #7b6b86;
      transition: all 0.2s ease;
      text-align: left;
    }

    .admin-menu button:hover,
    .admin-menu button.active {
      background: rgba(179,82,126,0.1);
      border-color: rgba(179,82,126,0.4);
      color: #B3527E;
    }

    .admin-content {
      flex: 1;
      padding: 40px;
      overflow-y: auto;
    }

    .admin-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 32px;
      padding-bottom: 20px;
      border-bottom: 2px solid rgba(179,82,126,0.1);
    }

    .admin-header h1 {
      color: #B3527E;
      margin: 0;
      font-size: 32px;
    }

    .logout-btn {
      padding: 10px 16px;
      background: linear-gradient(90deg, var(--accent1), var(--accent3));
      color: #4b2b3a;
      border: 0;
      border-radius: 8px;
      cursor: pointer;
      font-weight: 700;
      transition: all 0.2s ease;
    }

    .logout-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 20px rgba(179,82,126,0.2);
    }

    .section {
      display: none;
    }

    .section.active {
      display: block;
    }

    .orders-table {
      width: 100%;
      background: var(--card);
      border-radius: 12px;
      box-shadow: var(--shadow);
      overflow: hidden;
    }

    .orders-table table {
      width: 100%;
      border-collapse: collapse;
    }

    .orders-table th {
      background: linear-gradient(90deg, rgba(255,209,230,0.3), rgba(200,247,255,0.3));
      padding: 16px;
      text-align: left;
      font-weight: 700;
      color: #B3527E;
      border-bottom: 2px solid rgba(179,82,126,0.1);
    }

    .orders-table td {
      padding: 14px 16px;
      border-bottom: 1px solid rgba(179,82,126,0.05);
    }

    .orders-table tr:hover {
      background: rgba(255,209,230,0.1);
    }

    .status-badge {
      display: inline-block;
      padding: 6px 12px;
      border-radius: 20px;
      font-weight: 600;
      font-size: 12px;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .status-processing {
      background: rgba(255,242,200,0.6);
      color: #8B6F47;
    }

    .status-confirmed {
      background: rgba(232,255,216,0.6);
      color: #5C7A29;
    }

    .status-shipped {
      background: rgba(200,247,255,0.6);
      color: #1B5E7E;
    }

    .status-delivered {
      background: rgba(179,82,126,0.1);
      color: #B3527E;
    }

    .status-cancelled {
      background: rgba(255,200,200,0.4);
      color: #8B2C2C;
    }

    .status-select {
      padding: 6px 10px;
      border: 1px solid rgba(179,82,126,0.2);
      border-radius: 6px;
      background: white;
      color: #362538;
      cursor: pointer;
      font-weight: 600;
      transition: all 0.2s ease;
    }

    .status-select:hover {
      border-color: rgba(179,82,126,0.4);
    }

    .action-btn {
      padding: 6px 12px;
      margin-right: 8px;
      background: rgba(179,82,126,0.1);
      border: 1px solid rgba(179,82,126,0.2);
      border-radius: 6px;
      cursor: pointer;
      font-weight: 600;
      color: #B3527E;
      transition: all 0.2s ease;
      font-size: 12px;
    }

    .action-btn:hover {
      background: rgba(179,82,126,0.2);
      border-color: rgba(179,82,126,0.4);
    }

    .stats-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 20px;
      margin-bottom: 32px;
    }

    .stat-card {
      background: var(--card);
      padding: 24px;
      border-radius: 12px;
      box-shadow: var(--shadow);
      text-align: center;
    }

    .stat-card h3 {
      color: #7b6b86;
      margin: 0 0 8px 0;
      font-size: 14px;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .stat-card .value {
      font-size: 32px;
      font-weight: 700;
      color: #B3527E;
      margin: 0;
    }

    .empty-message {
      text-align: center;
      padding: 40px;
      color: #7b6b86;
    }

    .empty-message p {
      margin: 0;
      font-size: 18px;
    }

    @media (max-width: 768px) {
      .admin-container {
        flex-direction: column;
      }

      .admin-sidebar {
        width: 100%;
        height: auto;
        position: relative;
        padding: 16px;
      }

      .admin-menu {
        display: flex;
        gap: 8px;
        overflow-x: auto;
      }

      .admin-menu li {
        margin-bottom: 0;
        flex-shrink: 0;
      }

      .admin-content {
        padding: 24px;
      }

      .orders-table {
        overflow-x: auto;
      }

      .stats-grid {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>
<body>
  <div class="admin-container">
    <!-- Sidebar -->
    <aside class="admin-sidebar">
      <h2>üîê Admin Panel</h2>
      <ul class="admin-menu">
        <li>
          <button class="menu-btn active" data-section="dashboard">
            üìä Dashboard
          </button>
        </li>
        <li>
          <button class="menu-btn" data-section="orders">
            üì¶ Orders
          </button>
        </li>
        <li>
          <button class="menu-btn" data-section="settings">
            ‚öôÔ∏è Settings
          </button>
        </li>
      </ul>
      <hr style="margin: 20px 0; border: 1px solid rgba(179,82,126,0.1);">
      <button class="logout-btn" onclick="logoutAdmin()" style="width: 100%;">
        üö™ Logout
      </button>
    </aside>

    <!-- Main Content -->
    <main class="admin-content">
      <div class="admin-header">
        <h1>Admin Dashboard</h1>
        <span id="adminEmail" style="color: #7b6b86; font-weight: 600;"></span>
      </div>

      <!-- Dashboard Section -->
      <section id="dashboard" class="section active">
        <h2 style="color: #B3527E; margin-top: 0;">Dashboard Overview</h2>
        <div class="stats-grid">
          <div class="stat-card">
            <h3>Total Orders</h3>
            <p class="value" id="totalOrders">0</p>
          </div>
          <div class="stat-card">
            <h3>Processing</h3>
            <p class="value" id="processingCount">0</p>
          </div>
          <div class="stat-card">
            <h3>Shipped</h3>
            <p class="value" id="shippedCount">0</p>
          </div>
          <div class="stat-card">
            <h3>Delivered</h3>
            <p class="value" id="deliveredCount">0</p>
          </div>
        </div>

        <div style="margin-top: 32px;">
          <h3 style="color: #B3527E;">Recent Orders</h3>
          <div id="dashboardOrders"></div>
        </div>
      </section>

      <!-- Orders Section -->
      <section id="orders" class="section">
        <h2 style="color: #B3527E; margin-top: 0;">Manage Orders</h2>
        
        <div style="margin-bottom: 20px;">
          <label style="color: #362538; font-weight: 600; display: block; margin-bottom: 8px;">
            Filter by Status:
          </label>
          <select id="statusFilter" onchange="filterOrders()" style="padding: 8px 12px; border-radius: 8px; border: 1px solid rgba(179,82,126,0.2); cursor: pointer;">
            <option value="">All Orders</option>
            <option value="Processing">Processing</option>
            <option value="Confirmed">Confirmed</option>
            <option value="Shipped">Shipped</option>
            <option value="Delivered">Delivered</option>
            <option value="Cancelled">Cancelled</option>
          </select>
        </div>

        <div class="orders-table">
          <table>
            <thead>
              <tr>
                <th>Order ID</th>
                <th>Items</th>
                <th>Total</th>
                <th>Date</th>
                <th>Current Status</th>
                <th>Update Status</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody id="ordersTableBody">
              <tr>
                <td colspan="7" style="text-align: center; padding: 40px; color: #7b6b86;">
                  No orders yet
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </section>

      <!-- Settings Section -->
      <section id="settings" class="section">
        <h2 style="color: #B3527E; margin-top: 0;">Admin Settings</h2>
        <div style="background: var(--card); padding: 24px; border-radius: 12px; box-shadow: var(--shadow); max-width: 500px;">
          <h3 style="color: #B3527E;">Account Information</h3>
          <div style="margin-bottom: 16px;">
            <label style="display: block; color: #362538; font-weight: 600; margin-bottom: 4px;">Admin Email:</label>
            <p id="settingsEmail" style="margin: 0; padding: 8px; background: rgba(255,209,230,0.1); border-radius: 6px;"></p>
          </div>
          
          <h3 style="color: #B3527E; margin-top: 24px;">Danger Zone</h3>
          <p style="color: #7b6b86; font-size: 14px;">Clear all order data from the system.</p>
          <button onclick="clearAllOrders()" class="btn primary" style="background: linear-gradient(90deg, #ff6b6b, #ff8787);">
            Clear All Orders
          </button>

          <h3 style="color: #B3527E; margin-top: 24px;">System Information</h3>
          <div style="padding: 12px; background: rgba(200,247,255,0.1); border-radius: 8px; border-left: 4px solid var(--accent2);">
            <p style="margin: 0; font-size: 12px; color: #7b6b86;">
              <strong>Admin Password:</strong> admin123 (for testing)<br>
              <strong>Last Updated:</strong> <span id="lastUpdated"></span><br>
              <strong>Total Orders in System:</strong> <span id="systemOrderCount">0</span>
            </p>
          </div>
        </div>
      </section>
    </main>
  </div>

  <script src="script.js"></script>
  <script>
    // Check if admin is logged in
    window.addEventListener('DOMContentLoaded', () => {
      const isAdminLoggedIn = localStorage.getItem('isAdminLoggedIn');
      const adminEmail = localStorage.getItem('adminEmail');
      
      if (!isAdminLoggedIn) {
        alert('Access Denied! Please login as admin.');
        window.location.href = 'login.html';
        return;
      }

      // Set admin email
      document.getElementById('adminEmail').textContent = adminEmail || 'Admin';
      document.getElementById('settingsEmail').textContent = adminEmail || 'Not set';

      // Load orders and update UI
      loadAdminDashboard();

      // Menu button functionality
      document.querySelectorAll('.menu-btn').forEach(btn => {
        btn.addEventListener('click', () => {
          // Remove active class from all buttons
          document.querySelectorAll('.menu-btn').forEach(b => b.classList.remove('active'));
          // Add active class to clicked button
          btn.classList.add('active');

          // Hide all sections
          document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
          // Show selected section
          const sectionId = btn.dataset.section;
          document.getElementById(sectionId).classList.add('active');

          // Refresh data if switching to orders
          if (sectionId === 'orders') {
            loadOrdersTable();
          } else if (sectionId === 'dashboard') {
            loadAdminDashboard();
          }
        });
      });

      // Set last updated time
      document.getElementById('lastUpdated').textContent = new Date().toLocaleString();
    });

    function loadAdminDashboard() {
      const orders = JSON.parse(localStorage.getItem('orders')) || [];
      
      // Update stats
      document.getElementById('totalOrders').textContent = orders.length;
      document.getElementById('processingCount').textContent = orders.filter(o => o.status === 'Processing').length;
      document.getElementById('shippedCount').textContent = orders.filter(o => o.status === 'Shipped').length;
      document.getElementById('deliveredCount').textContent = orders.filter(o => o.status === 'Delivered').length;
      document.getElementById('systemOrderCount').textContent = orders.length;

      // Show recent orders
      const dashboardOrders = document.getElementById('dashboardOrders');
      const recentOrders = orders.slice(-5).reverse();

      if (recentOrders.length === 0) {
        dashboardOrders.innerHTML = '<p style="text-align: center; color: #7b6b86; padding: 20px;">No orders yet</p>';
        return;
      }

      dashboardOrders.innerHTML = `
        <div class="orders-table">
          <table>
            <thead>
              <tr>
                <th>Order ID</th>
                <th>Items</th>
                <th>Total</th>
                <th>Date</th>
                <th>Status</th>
              </tr>
            </thead>
            <tbody>
              ${recentOrders.map((order, index) => `
                <tr>
                  <td>#ORD-${String(orders.length - index).padStart(4, '0')}</td>
                  <td style="max-width: 250px; word-break: break-word;">${order.items}</td>
                  <td>${order.total}</td>
                  <td>${order.date}</td>
                  <td><span class="status-badge status-${order.status.toLowerCase()}">${order.status}</span></td>
                </tr>
              `).join('')}
            </tbody>
          </table>
        </div>
      `;
    }

    function loadOrdersTable() {
      const orders = JSON.parse(localStorage.getItem('orders')) || [];
      const tbody = document.getElementById('ordersTableBody');

      if (orders.length === 0) {
        tbody.innerHTML = `
          <tr>
            <td colspan="7" style="text-align: center; padding: 40px; color: #7b6b86;">
              No orders found
            </td>
          </tr>
        `;
        return;
      }

      tbody.innerHTML = orders.map((order, index) => `
        <tr>
          <td><strong>#ORD-${String(index + 1).padStart(4, '0')}</strong></td>
          <td style="max-width: 250px; word-break: break-word;">${order.items}</td>
          <td>${order.total}</td>
          <td>${order.date}</td>
          <td><span class="status-badge status-${order.status.toLowerCase()}">${order.status}</span></td>
          <td>
            <select class="status-select" onchange="updateOrderStatus(${index}, this.value)">
              <option value="Processing" ${order.status === 'Processing' ? 'selected' : ''}>Processing</option>
              <option value="Confirmed" ${order.status === 'Confirmed' ? 'selected' : ''}>Confirmed</option>
              <option value="Shipped" ${order.status === 'Shipped' ? 'selected' : ''}>Shipped</option>
              <option value="Delivered" ${order.status === 'Delivered' ? 'selected' : ''}>Delivered</option>
              <option value="Cancelled" ${order.status === 'Cancelled' ? 'selected' : ''}>Cancelled</option>
            </select>
          </td>
          <td>
            <button class="action-btn" onclick="deleteOrder(${index})">Delete</button>
          </td>
        </tr>
      `).join('');
    }

    function updateOrderStatus(index, newStatus) {
      const orders = JSON.parse(localStorage.getItem('orders')) || [];
      orders[index].status = newStatus;
      localStorage.setItem('orders', JSON.stringify(orders));
      
      loadOrdersTable();
      loadAdminDashboard();
      alert(`Order #ORD-${String(index + 1).padStart(4, '0')} updated to "${newStatus}" ‚úÖ`);
    }

    function deleteOrder(index) {
      if (confirm('Are you sure you want to delete this order? This action cannot be undone.')) {
        const orders = JSON.parse(localStorage.getItem('orders')) || [];
        orders.splice(index, 1);
        localStorage.setItem('orders', JSON.stringify(orders));
        
        loadOrdersTable();
        loadAdminDashboard();
        alert('Order deleted successfully ‚úÖ');
      }
    }

    function filterOrders() {
      const selectedStatus = document.getElementById('statusFilter').value;
      const orders = JSON.parse(localStorage.getItem('orders')) || [];
      const tbody = document.getElementById('ordersTableBody');

      const filtered = selectedStatus ? orders.filter(o => o.status === selectedStatus) : orders;

      if (filtered.length === 0) {
        tbody.innerHTML = `
          <tr>
            <td colspan="7" style="text-align: center; padding: 40px; color: #7b6b86;">
              No orders with status "${selectedStatus}"
            </td>
          </tr>
        `;
        return;
      }

      tbody.innerHTML = filtered.map((order, index) => {
        const originalIndex = orders.indexOf(order);
        return `
          <tr>
            <td><strong>#ORD-${String(originalIndex + 1).padStart(4, '0')}</strong></td>
            <td style="max-width: 250px; word-break: break-word;">${order.items}</td>
            <td>${order.total}</td>
            <td>${order.date}</td>
            <td><span class="status-badge status-${order.status.toLowerCase()}">${order.status}</span></td>
            <td>
              <select class="status-select" onchange="updateOrderStatus(${originalIndex}, this.value)">
                <option value="Processing" ${order.status === 'Processing' ? 'selected' : ''}>Processing</option>
                <option value="Confirmed" ${order.status === 'Confirmed' ? 'selected' : ''}>Confirmed</option>
                <option value="Shipped" ${order.status === 'Shipped' ? 'selected' : ''}>Shipped</option>
                <option value="Delivered" ${order.status === 'Delivered' ? 'selected' : ''}>Delivered</option>
                <option value="Cancelled" ${order.status === 'Cancelled' ? 'selected' : ''}>Cancelled</option>
              </select>
            </td>
            <td>
              <button class="action-btn" onclick="deleteOrder(${originalIndex})">Delete</button>
            </td>
          </tr>
        `;
      }).join('');
    }

    function clearAllOrders() {
      if (confirm('‚ö†Ô∏è Warning! This will DELETE ALL orders from the system. This action cannot be undone. Continue?')) {
        if (confirm('Are you absolutely sure?')) {
          localStorage.setItem('orders', JSON.stringify([]));
          loadAdminDashboard();
          loadOrdersTable();
          alert('All orders have been cleared! ‚úÖ');
        }
      }
    }

    function logoutAdmin() {
      localStorage.removeItem('isAdminLoggedIn');
      localStorage.removeItem('adminEmail');
      alert('Logged out successfully! üëã');
      window.location.href = 'login.html';
    }
  </script>
</body>
</html>
